<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Device Repair Service</title>
    <link href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #1d1d1f;
            --secondary: #86868b;
            --accent: #0071e3;
            --border: #d2d2d7;
            --bg: #fbfbfd;
            --card-bg: #ffffff;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', system-ui, sans-serif;
            background: var(--bg);
            color: var(--primary);
            line-height: 1.5;
            -webkit-font-smoothing: antialiased;
        }

        /* Language Switcher */
        .language-switcher {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            gap: 8px;
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 4px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
        }

        .lang-btn {
            padding: 8px 16px;
            border: none;
            background: transparent;
            color: var(--secondary);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            border-radius: 16px;
            transition: all 0.2s;
            font-family: inherit;
        }

        .lang-btn:hover {
            color: var(--primary);
            background: var(--bg);
        }

        .lang-btn.active {
            background: var(--accent);
            color: white;
        }

        .container {
            max-width: 980px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Progress Steps */
        .progress-container {
            padding: 60px 0 40px;
        }

        .progress-steps {
            display: flex;
            justify-content: space-between;
            position: relative;
            margin-bottom: 20px;
        }

        .progress-line {
            position: absolute;
            top: 20px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--border);
            z-index: 0;
        }

        .progress-line-fill {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            background: var(--accent);
            transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            width: 0;
        }

        .step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 1;
            flex: 1;
        }

        .step-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--card-bg);
            border: 2px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 16px;
            color: var(--secondary);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            margin-bottom: 12px;
        }

        .step.active .step-circle {
            background: var(--accent);
            border-color: var(--accent);
            color: white;
            transform: scale(1.1);
        }

        .step.completed .step-circle {
            background: var(--accent);
            border-color: var(--accent);
            color: white;
        }

        .step-label {
            font-size: 13px;
            color: var(--secondary);
            font-weight: 500;
            text-align: center;
            transition: color 0.3s;
        }

        .step.active .step-label {
            color: var(--primary);
            font-weight: 600;
        }

        /* Content Sections */
        .content-section {
            display: none;
            animation: fadeInUp 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .content-section.active {
            display: block;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        h1 {
            font-size: 48px;
            font-weight: 700;
            letter-spacing: -0.02em;
            margin-bottom: 12px;
            text-align: center;
        }

        .subtitle {
            font-size: 21px;
            color: var(--secondary);
            text-align: center;
            margin-bottom: 50px;
            font-weight: 400;
        }

        /* Grid Layout */
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 16px;
            margin-bottom: 40px;
        }

        .card {
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 18px;
            padding: 32px 24px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(0, 113, 227, 0.05), transparent);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.08);
            border-color: var(--accent);
        }

        .card:hover::before {
            opacity: 1;
        }

        .card.selected {
            border-color: var(--accent);
            border-width: 2px;
            background: linear-gradient(135deg, rgba(0, 113, 227, 0.05), transparent);
        }

        .card-icon {
            font-size: 48px;
            margin-bottom: 16px;
            filter: grayscale(100%);
            transition: filter 0.3s;
        }

        .card-logo {
            width: 60px;
            height: 60px;
            object-fit: contain;
            margin-bottom: 16px;
            filter: grayscale(100%);
            transition: filter 0.3s;
            display: block;
            margin-left: auto;
            margin-right: auto;
        }

        .card:hover .card-logo,
        .card.selected .card-logo {
            filter: grayscale(0%);
        }

        .card-logo.hidden {
            display: none;
        }

        /* Other brands dropdown */
        #otherBrandsDropdown {
            margin-top: 20px;
            display: none;
        }

        #otherBrandsDropdown.visible {
            display: block;
        }

        .card:hover .card-icon,
        .card.selected .card-icon {
            filter: grayscale(0%);
        }

        .card-title {
            font-size: 17px;
            font-weight: 600;
            margin-bottom: 6px;
            color: var(--primary);
        }

        .card-subtitle {
            font-size: 14px;
            color: var(--secondary);
            font-weight: 400;
        }

        /* Form */
        .form-group {
            margin-bottom: 24px;
        }

        label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--primary);
        }

        input, textarea {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid var(--border);
            border-radius: 12px;
            font-size: 16px;
            font-family: inherit;
            background: var(--card-bg);
            transition: all 0.2s;
            color: var(--primary);
        }

        select {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid var(--border);
            border-radius: 12px;
            font-size: 16px;
            font-family: inherit;
            background: var(--card-bg);
            transition: all 0.2s;
            color: var(--primary);
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg width='12' height='8' viewBox='0 0 12 8' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1.5L6 6.5L11 1.5' stroke='%2386868b' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 16px center;
            padding-right: 48px;
        }

        select:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 4px rgba(0, 113, 227, 0.1);
        }

        input:focus, textarea:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 4px rgba(0, 113, 227, 0.1);
        }

        textarea {
            resize: vertical;
            min-height: 100px;
        }

        /* Summary Card */
        .summary-card {
            background: linear-gradient(135deg, #f5f5f7 0%, #ffffff 100%);
            border: 1px solid var(--border);
            border-radius: 18px;
            padding: 32px;
            margin-bottom: 40px;
        }

        .summary-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 20px;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            padding: 16px 0;
            border-bottom: 1px solid var(--border);
        }

        .summary-item:last-child {
            border-bottom: none;
        }

        .summary-label {
            font-size: 15px;
            color: var(--secondary);
            font-weight: 500;
        }

        .summary-value {
            font-size: 15px;
            font-weight: 600;
            color: var(--primary);
        }

        /* Selected Repairs Display */
        .selected-repairs-display {
            background: linear-gradient(135deg, rgba(0, 113, 227, 0.08), rgba(0, 113, 227, 0.02));
            border: 1px solid rgba(0, 113, 227, 0.2);
            border-radius: 12px;
            padding: 20px;
            margin: 30px 0;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .selected-repairs-text {
            font-size: 15px;
            color: var(--primary);
            font-weight: 500;
            text-align: center;
        }

        .selected-repairs-text.empty {
            color: var(--secondary);
            font-style: italic;
        }

        .repair-tag {
            display: inline-block;
            background: var(--accent);
            color: white;
            padding: 6px 14px;
            border-radius: 20px;
            margin: 4px;
            font-size: 14px;
            font-weight: 500;
        }

        /* Service Type Selector */
        .service-type-selector {
            display: flex;
            gap: 16px;
            margin-bottom: 40px;
        }

        .service-option {
            flex: 1;
            background: var(--card-bg);
            border: 2px solid var(--border);
            border-radius: 18px;
            padding: 24px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        .service-option:hover {
            border-color: var(--accent);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.06);
        }

        .service-option.selected {
            border-color: var(--accent);
            background: linear-gradient(135deg, rgba(0, 113, 227, 0.05), transparent);
        }

        .service-badge {
            display: inline-block;
            background: #34c759;
            color: white;
            font-size: 11px;
            font-weight: 600;
            padding: 4px 10px;
            border-radius: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 12px;
        }

        .service-icon {
            font-size: 40px;
            margin-bottom: 16px;
        }

        .service-title {
            font-size: 19px;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--primary);
        }

        .service-description {
            font-size: 14px;
            color: var(--secondary);
            line-height: 1.4;
        }

        /* Date and Time Picker */
        .date-time-container {
            margin-bottom: 40px;
        }

        .date-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 12px;
            margin-bottom: 32px;
        }

        .date-card {
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 16px 12px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }

        .date-card:hover {
            border-color: var(--accent);
            transform: translateY(-2px);
        }

        .date-card.selected {
            border-color: var(--accent);
            border-width: 2px;
            background: linear-gradient(135deg, rgba(0, 113, 227, 0.08), transparent);
        }

        .date-day {
            font-size: 13px;
            color: var(--secondary);
            margin-bottom: 4px;
        }

        .date-number {
            font-size: 24px;
            font-weight: 600;
            color: var(--primary);
        }

        .date-month {
            font-size: 12px;
            color: var(--secondary);
            margin-top: 4px;
        }

        .time-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 12px;
        }

        .time-card {
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 14px 16px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
            font-size: 15px;
            font-weight: 500;
            color: var(--primary);
        }

        .time-card:hover {
            border-color: var(--accent);
            transform: translateY(-2px);
        }

        .time-card.selected {
            border-color: var(--accent);
            border-width: 2px;
            background: var(--accent);
            color: white;
        }

        .time-card.unavailable {
            opacity: 0.4;
            cursor: not-allowed;
            pointer-events: none;
        }

        .section-title {
            font-size: 17px;
            font-weight: 600;
            margin-bottom: 16px;
            color: var(--primary);
        }

        /* Repair Categories */
        .repair-category {
            margin-bottom: 24px;
        }

        .category-header {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px;
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            user-select: none;
        }

        .category-header:hover {
            border-color: var(--accent);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .category-header.active {
            background: linear-gradient(135deg, rgba(0, 113, 227, 0.05), transparent);
            border-color: var(--accent);
        }

        .category-title {
            font-size: 17px;
            font-weight: 600;
            color: var(--primary);
            flex: 1;
        }

        .category-count {
            font-size: 14px;
            color: var(--secondary);
            background: var(--bg);
            padding: 4px 12px;
            border-radius: 12px;
            font-weight: 500;
        }

        .category-header.active .category-count {
            background: rgba(0, 113, 227, 0.1);
            color: var(--accent);
        }

        .category-chevron {
            font-size: 20px;
            color: var(--secondary);
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .category-header.active .category-chevron {
            transform: rotate(180deg);
            color: var(--accent);
        }

        .category-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .category-content.expanded {
            max-height: 2000px;
        }

        .category-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 16px;
            padding: 20px 0;
        }

        @media (max-width: 768px) {
            .category-grid {
                grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
                gap: 12px;
            }
        }

        /* Buttons */
        .button-group {
            display: flex;
            gap: 12px;
            justify-content: center;
            margin-top: 40px;
        }

        button {
            padding: 14px 32px;
            border-radius: 980px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: none;
            font-family: inherit;
        }

        .btn-primary {
            background: var(--accent);
            color: white;
        }

        .btn-primary:hover {
            background: #0077ed;
            transform: scale(1.02);
        }

        .btn-primary:disabled {
            background: var(--border);
            cursor: not-allowed;
            transform: scale(1);
        }

        .btn-secondary {
            background: transparent;
            color: var(--accent);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--bg);
            border-color: var(--accent);
        }

        /* Success Message */
        .success-message {
            text-align: center;
            padding: 60px 20px;
        }

        .success-icon {
            font-size: 80px;
            margin-bottom: 24px;
            animation: scaleIn 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes scaleIn {
            from {
                transform: scale(0);
            }
            to {
                transform: scale(1);
            }
        }

        .success-title {
            font-size: 40px;
            font-weight: 700;
            margin-bottom: 16px;
        }

        .success-text {
            font-size: 19px;
            color: var(--secondary);
            margin-bottom: 40px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            h1 {
                font-size: 32px;
            }

            .subtitle {
                font-size: 17px;
            }

            .grid {
                grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
                gap: 12px;
            }

            .card {
                padding: 24px 16px;
            }

            .card-icon {
                font-size: 36px;
            }

            .card-title {
                font-size: 15px;
            }

            .card-subtitle {
                font-size: 12px;
            }

            .progress-steps {
                padding: 0 10px;
            }

            .step-label {
                font-size: 11px;
            }

            .step-circle {
                width: 36px;
                height: 36px;
                font-size: 14px;
            }

            .button-group {
                flex-direction: column;
            }

            button {
                width: 100%;
            }

            .summary-card {
                padding: 24px;
            }
        }
    </style>
</head>
<body>
    <!-- Language Switcher -->
    <div class="language-switcher">
        <button class="lang-btn active" data-lang="en">English</button>
        <button class="lang-btn" data-lang="de">Deutsch</button>
    </div>

    <div class="container">
        <div class="progress-container">
            <div class="progress-steps">
                <div class="progress-line">
                    <div class="progress-line-fill" id="progressFill"></div>
                </div>
                <div class="step active" data-step="1">
                    <div class="step-circle">1</div>
                    <div class="step-label">Select Device</div>
                </div>
                <div class="step" data-step="2">
                    <div class="step-circle">2</div>
                    <div class="step-label">Select Repair</div>
                </div>
                <div class="step" data-step="3">
                    <div class="step-circle">3</div>
                    <div class="step-label">Get Quote</div>
                </div>
                <div class="step" data-step="4" id="step4indicator" style="display: none;">
                    <div class="step-circle">4</div>
                    <div class="step-label">Book Appointment</div>
                </div>
            </div>
        </div>

        <!-- Step 1: Select Device -->
        <div id="step1" class="content-section active">
            <h1>Select your device</h1>
            <p class="subtitle">Choose the device you need repaired</p>
            
            <div class="grid" id="deviceGrid"></div>
            
            <!-- For Smartphones: Brand Selection -->
            <div id="brandGrid" class="grid" style="display: none;"></div>

            <!-- Other Brands Dropdown -->
            <div id="otherBrandsDropdown">
                <div class="form-group">
                    <label for="otherBrandSelect">Select other brand</label>
                    <select id="otherBrandSelect">
                        <option value="">Choose a brand...</option>
                    </select>
                </div>
            </div>

            <!-- Custom Brand Text Input -->
            <div id="customBrandInput" style="display: none; margin-top: 20px;">
                <div class="form-group">
                    <label for="customBrandText">Enter brand name</label>
                    <input type="text" id="customBrandText" placeholder="e.g., OnePlus, Xiaomi, etc.">
                </div>
            </div>
            
            <!-- For Smartphones: Model Dropdown -->
            <div id="modelDropdown" style="display: none; margin-bottom: 40px;">
                <div class="form-group">
                    <label for="modelSelect">Select Model</label>
                    <select id="modelSelect">
                        <option value="">Choose a model...</option>
                    </select>
                </div>
            </div>

            <!-- Custom Model Text Input -->
            <div id="customModelInput" style="display: none; margin-bottom: 40px;">
                <div class="form-group">
                    <label for="customModelText">Enter model name</label>
                    <input type="text" id="customModelText" placeholder="e.g., Pro Max, Note 10, etc.">
                </div>
            </div>

            <!-- For Non-Smartphones: Text Input -->
            <div id="deviceTextInput" style="display: none; margin-bottom: 40px;">
                <div class="form-group">
                    <label for="deviceText">Please specify your device</label>
                    <input type="text" id="deviceText" placeholder="e.g., MacBook Pro 2021, Apple Watch Series 8">
                </div>
            </div>

            <div class="button-group">
                <button class="btn-primary" id="nextToRepair" disabled>Continue</button>
            </div>
        </div>

        <!-- Step 2: Select Repair -->
        <div id="step2" class="content-section">
            <h1>What needs fixing?</h1>
            <p class="subtitle">Select one or more repair services you need</p>
            
            <div class="selected-repairs-display">
                <div class="selected-repairs-text empty" id="selectedRepairsText">No repairs selected yet</div>
            </div>

            <div id="repairCategories"></div>

            <div class="button-group">
                <button class="btn-secondary" id="backToDevice">Back</button>
                <button class="btn-primary" id="nextToQuote" disabled>Continue</button>
            </div>
        </div>

        <!-- Step 3: Get Quote -->
        <div id="step3" class="content-section">
            <h1>Get your quote</h1>
            <p class="subtitle">We'll contact you with a detailed estimate</p>
            
            <div class="summary-card">
                <div class="summary-title">Repair Summary</div>
                <div class="summary-item">
                    <span class="summary-label">Device</span>
                    <span class="summary-value" id="summaryDevice">-</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">Model</span>
                    <span class="summary-value" id="summaryModel">-</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">Repairs</span>
                    <span class="summary-value" id="summaryRepair">-</span>
                </div>
            </div>

            <!-- Service Type Selector -->
            <div class="service-type-selector">
                <div class="service-option" data-service="shop" id="shopOption">
                    <div class="service-badge">FREE</div>
                    <div class="service-icon">üè™</div>
                    <div class="service-title">Visit our shop</div>
                    <div class="service-description">Repaired while you wait</div>
                </div>
                <div class="service-option" data-service="post" id="postOption">
                    <div class="service-badge">FREE</div>
                    <div class="service-icon">üì¶</div>
                    <div class="service-title">Send device</div>
                    <div class="service-description">Repair within 24 hours</div>
                </div>
            </div>

            <form id="quoteForm">
                <div class="form-group">
                    <label for="firstName">First Name *</label>
                    <input type="text" id="firstName" required placeholder="John">
                </div>

                <div class="form-group">
                    <label for="lastName">Last Name *</label>
                    <input type="text" id="lastName" required placeholder="Doe">
                </div>

                <div class="form-group">
                    <label for="email">Email Address *</label>
                    <input type="email" id="email" required placeholder="john@example.com">
                </div>

                <div class="form-group">
                    <label for="phone">Phone Number *</label>
                    <input type="tel" id="phone" required placeholder="+1 (555) 123-4567">
                </div>

                <div class="form-group">
                    <label for="street">Street Name *</label>
                    <input type="text" id="street" required placeholder="Main Street">
                </div>

                <div class="form-group">
                    <label for="houseNumber">House Number *</label>
                    <input type="text" id="houseNumber" required placeholder="123">
                </div>

                <div class="form-group">
                    <label for="postalCode">Postal Code *</label>
                    <input type="text" id="postalCode" required placeholder="12345" pattern="[0-9]{5}" maxlength="5">
                </div>

                <div class="form-group">
                    <label for="city">City *</label>
                    <input type="text" id="city" required placeholder="New York">
                </div>

                <div class="form-group">
                    <label for="imei">IMEI Number (Optional)</label>
                    <input type="text" id="imei" placeholder="123456789012345" pattern="[0-9]{15}" maxlength="15">
                </div>

                <div class="form-group">
                    <label for="notes">Additional Notes (Optional)</label>
                    <textarea id="notes" placeholder="Tell us more about the issue..."></textarea>
                </div>

                <div class="button-group">
                    <button type="button" class="btn-secondary" id="backToRepair">Back</button>
                    <button type="button" class="btn-primary" id="continueFromQuote">Continue</button>
                </div>
            </form>
        </div>

        <!-- Step 4: Book Appointment (Conditional) -->
        <div id="step4" class="content-section">
            <h1>Book an appointment</h1>
            <p class="subtitle">Choose your preferred date and time</p>

            <div class="date-time-container">
                <div class="section-title">Select a date</div>
                <div class="date-grid" id="dateGrid"></div>

                <div class="section-title" style="margin-top: 32px;">Select a time slot</div>
                <div class="time-grid" id="timeGrid"></div>
            </div>

            <div class="button-group">
                <button type="button" class="btn-secondary" id="backToQuote">Back</button>
                <button type="button" class="btn-primary" id="submitAppointment" disabled>Confirm Appointment</button>
            </div>
        </div>

        <!-- Success Message -->
        <div id="success" class="content-section">
            <div class="success-message">
                <div class="success-icon">‚úì</div>
                <h2 class="success-title">Request Submitted!</h2>
                <p class="success-text">We'll contact you shortly with a detailed quote and next steps.</p>
                <button class="btn-primary" onclick="window.location.href='/'">Back to homepage</button>
            </div>
        </div>
    </div>

    <script>
        // Translations
        const translations = {
            en: {
                // Progress Steps
                stepDevice: 'Select Device',
                stepRepair: 'Select Repair',
                stepQuote: 'Get Quote',
                stepAppointment: 'Book Appointment',
                
                // Step 1
                titleDevice: 'Select your device',
                subtitleDevice: 'Choose the device you need repaired',
                deviceSmartphones: 'Smartphones',
                deviceSmartphonesDesc: 'Mobile phones',
                deviceLaptops: 'Laptops',
                deviceLaptopsDesc: 'Portable computers',
                deviceWearables: 'Wearables',
                deviceWearablesDesc: 'Smart watches',
                deviceOther: 'Other',
                deviceOtherDesc: 'Other devices',
                labelSelectModel: 'Select Model',
                optionChooseModel: 'Choose a model...',
                optionOtherModel: 'Other model (not in list)',
                labelCustomModel: 'Enter model name',
                placeholderCustomModel: 'e.g., Pro Max, Note 10, etc.',
                labelDeviceText: 'Please specify your device',
                placeholderDeviceText: 'e.g., MacBook Pro 2021, Apple Watch Series 8',
                labelOtherBrand: 'Select other brand',
                optionChooseBrand: 'Choose a brand...',
                optionBrandNotInList: 'Not in list',
                labelCustomBrand: 'Enter brand name',
                placeholderCustomBrand: 'e.g., OnePlus, Xiaomi, etc.',
                otherBrandCard: 'Other',
                otherBrandCardDesc: 'More brands',
                
                // Step 2
                titleRepair: 'What needs fixing?',
                subtitleRepair: 'Select one or more repair services you need',
                noRepairsSelected: 'No repairs selected yet',
                
                // Step 3
                titleQuote: 'Get your quote',
                subtitleQuote: "We'll contact you with a detailed estimate",
                summaryTitle: 'Repair Summary',
                summaryDevice: 'Device',
                summaryModel: 'Model',
                summaryRepairs: 'Repairs',
                
                // Service Types
                serviceShopTitle: 'Visit our shop',
                serviceShopDesc: 'Repaired while you wait',
                servicePostTitle: 'Send device',
                servicePostDesc: 'Repair within 24 hours',
                serviceBadge: 'FREE',
                
                // Step 4
                titleAppointment: 'Book an appointment',
                subtitleAppointment: 'Choose your preferred date and time',
                labelSelectDate: 'Select a date',
                labelSelectTime: 'Select a time slot',
                
                // Days of week
                dayMon: 'Mon',
                dayTue: 'Tue',
                dayWed: 'Wed',
                dayThu: 'Thu',
                dayFri: 'Fri',
                daySat: 'Sat',
                daySun: 'Sun',
                
                // Months
                monthJan: 'Jan',
                monthFeb: 'Feb',
                monthMar: 'Mar',
                monthApr: 'Apr',
                monthMay: 'May',
                monthJun: 'Jun',
                monthJul: 'Jul',
                monthAug: 'Aug',
                monthSep: 'Sep',
                monthOct: 'Oct',
                monthNov: 'Nov',
                monthDec: 'Dec',
                
                // Form labels
                labelFirstName: 'First Name',
                labelLastName: 'Last Name',
                labelEmail: 'Email Address',
                labelPhone: 'Phone Number',
                labelStreet: 'Street Name',
                labelHouseNumber: 'House Number',
                labelPostalCode: 'Postal Code',
                labelCity: 'City',
                labelImei: 'IMEI Number (Optional)',
                labelNotes: 'Additional Notes (Optional)',
                
                // Placeholders
                placeholderFirstName: 'John',
                placeholderLastName: 'Doe',
                placeholderEmail: 'john@example.com',
                placeholderPhone: '+49 123 4567890',
                placeholderStreet: 'Hauptstra√üe',
                placeholderHouseNumber: '123',
                placeholderPostalCode: '12345',
                placeholderCity: 'Berlin',
                placeholderImei: '123456789012345',
                placeholderNotes: 'Tell us more about the issue...',
                
                // Buttons
                btnContinue: 'Continue',
                btnBack: 'Back',
                btnSubmit: 'Submit Request',
                btnConfirmAppointment: 'Confirm Appointment',
                btnBackHome: 'Back to homepage',
                
                // Success
                successTitle: 'Request Submitted!',
                successText: "We'll contact you shortly with a detailed quote and next steps.",
                
                // Repairs
                repairScreen: 'Screen Repair',
                repairBattery: 'Battery Replacement',
                repairWater: 'Water Damage',
                repairCamera: 'Camera Repair',
                repairCharging: 'Charging Port',
                repairSpeaker: 'Speaker Repair',
                repairButton: 'Button Repair',
                repairBackGlass: 'Back Glass',
                repairSoftware: 'Software Issue',
                repairData: 'Data Recovery',
                repairMicrophone: 'Microphone',
                repairFaceID: 'Face ID Repair',
                repairMotherboard: 'Motherboard',
                repairAntenna: 'Antenna Repair',
                repairVibration: 'Vibration Motor',
                repairHome: 'Home Button',
                repairSIM: 'SIM Card Tray',
                repairWiFi: 'WiFi/Bluetooth',
                repairTouchID: 'Touch ID',
                repairCheckup: 'General Checkup',
                
                // Repair Categories
                categoryDisplay: 'Display & Touch',
                categoryAccident: 'Accident & Physical Damage',
                categoryPower: 'Power & Charging',
                categoryAudio: 'Audio & Connectivity',
                categoryAdvanced: 'Advanced & Internal',
            },
            de: {
                // Progress Steps
                stepDevice: 'Ger√§t w√§hlen',
                stepRepair: 'Reparatur w√§hlen',
                stepQuote: 'Angebot erhalten',
                stepAppointment: 'Termin buchen',
                
                // Step 1
                titleDevice: 'W√§hlen Sie Ihr Ger√§t',
                subtitleDevice: 'W√§hlen Sie das zu reparierende Ger√§t',
                deviceSmartphones: 'Smartphones',
                deviceSmartphonesDesc: 'Mobiltelefone',
                deviceLaptops: 'Laptops',
                deviceLaptopsDesc: 'Tragbare Computer',
                deviceWearables: 'Wearables',
                deviceWearablesDesc: 'Smartwatches',
                deviceOther: 'Andere',
                deviceOtherDesc: 'Andere Ger√§te',
                labelSelectModel: 'Modell ausw√§hlen',
                optionChooseModel: 'W√§hlen Sie ein Modell...',
                optionOtherModel: 'Anderes Modell (nicht in der Liste)',
                labelCustomModel: 'Modellnamen eingeben',
                placeholderCustomModel: 'z.B. Pro Max, Note 10, usw.',
                labelDeviceText: 'Bitte geben Sie Ihr Ger√§t an',
                placeholderDeviceText: 'z.B. MacBook Pro 2021, Apple Watch Series 8',
                labelOtherBrand: 'Andere Marke ausw√§hlen',
                optionChooseBrand: 'W√§hlen Sie eine Marke...',
                optionBrandNotInList: 'Nicht in der Liste',
                labelCustomBrand: 'Markennamen eingeben',
                placeholderCustomBrand: 'z.B. OnePlus, Xiaomi, usw.',
                otherBrandCard: 'Andere',
                otherBrandCardDesc: 'Weitere Marken',
                
                // Step 2
                titleRepair: 'Was muss repariert werden?',
                subtitleRepair: 'W√§hlen Sie einen oder mehrere Reparaturdienste',
                noRepairsSelected: 'Noch keine Reparaturen ausgew√§hlt',
                
                // Step 3
                titleQuote: 'Ihr Angebot erhalten',
                subtitleQuote: 'Wir kontaktieren Sie mit einem detaillierten Kostenvoranschlag',
                summaryTitle: 'Reparatur√ºbersicht',
                summaryDevice: 'Ger√§t',
                summaryModel: 'Modell',
                summaryRepairs: 'Reparaturen',
                
                // Service Types
                serviceShopTitle: 'Besuchen Sie unser Gesch√§ft',
                serviceShopDesc: 'Erledigt, w√§hrend Sie warten',
                servicePostTitle: 'Ger√§t versenden',
                servicePostDesc: 'Reparatur binnen 24 Stunden',
                serviceBadge: 'GRATIS',
                
                // Step 4
                titleAppointment: 'Termin buchen',
                subtitleAppointment: 'W√§hlen Sie Ihr bevorzugtes Datum und Ihre Uhrzeit',
                labelSelectDate: 'W√§hlen Sie ein Datum',
                labelSelectTime: 'W√§hlen Sie einen Zeitslot',
                
                // Days of week
                dayMon: 'Mo',
                dayTue: 'Di',
                dayWed: 'Mi',
                dayThu: 'Do',
                dayFri: 'Fr',
                daySat: 'Sa',
                daySun: 'So',
                
                // Months
                monthJan: 'Jan',
                monthFeb: 'Feb',
                monthMar: 'M√§r',
                monthApr: 'Apr',
                monthMay: 'Mai',
                monthJun: 'Jun',
                monthJul: 'Jul',
                monthAug: 'Aug',
                monthSep: 'Sep',
                monthOct: 'Okt',
                monthNov: 'Nov',
                monthDec: 'Dez',
                
                // Form labels
                labelFirstName: 'Vorname',
                labelLastName: 'Nachname',
                labelEmail: 'E-Mail-Adresse',
                labelPhone: 'Telefonnummer',
                labelStreet: 'Stra√üe',
                labelHouseNumber: 'Hausnummer',
                labelPostalCode: 'Postleitzahl',
                labelCity: 'Stadt',
                labelImei: 'IMEI-Nummer (Optional)',
                labelNotes: 'Zus√§tzliche Anmerkungen (Optional)',
                
                // Placeholders
                placeholderFirstName: 'Max',
                placeholderLastName: 'Mustermann',
                placeholderEmail: 'max@beispiel.de',
                placeholderPhone: '+49 123 4567890',
                placeholderStreet: 'Hauptstra√üe',
                placeholderHouseNumber: '123',
                placeholderPostalCode: '12345',
                placeholderCity: 'Berlin',
                placeholderImei: '123456789012345',
                placeholderNotes: 'Erz√§hlen Sie uns mehr √ºber das Problem...',
                
                // Buttons
                btnContinue: 'Weiter',
                btnBack: 'Zur√ºck',
                btnSubmit: 'Anfrage senden',
                btnConfirmAppointment: 'Termin best√§tigen',
                btnBackHome: 'Zur√ºck zur Startseite',
                
                // Success
                successTitle: 'Anfrage gesendet!',
                successText: 'Wir kontaktieren Sie in K√ºrze mit einem detaillierten Angebot und den n√§chsten Schritten.',
                
                // Repairs
                repairScreen: 'Display-Reparatur',
                repairBattery: 'Akku-Austausch',
                repairWater: 'Wasserschaden',
                repairCamera: 'Kamera-Reparatur',
                repairCharging: 'Ladebuchse',
                repairSpeaker: 'Lautsprecher-Reparatur',
                repairButton: 'Tasten-Reparatur',
                repairBackGlass: 'R√ºckseiten-Glas',
                repairSoftware: 'Software-Problem',
                repairData: 'Datenwiederherstellung',
                repairMicrophone: 'Mikrofon',
                repairFaceID: 'Face ID Reparatur',
                repairMotherboard: 'Hauptplatine',
                repairAntenna: 'Antennen-Reparatur',
                repairVibration: 'Vibrationsmotor',
                repairHome: 'Home-Taste',
                repairSIM: 'SIM-Kartenfach',
                repairWiFi: 'WLAN/Bluetooth',
                repairTouchID: 'Touch ID',
                repairCheckup: 'Allgemeine √úberpr√ºfung',
                
                // Repair Categories
                categoryDisplay: 'Display & Touch',
                categoryAccident: 'Unfall & Physische Sch√§den',
                categoryPower: 'Strom & Laden',
                categoryAudio: 'Audio & Konnektivit√§t',
                categoryAdvanced: 'Erweitert & Intern',
            }
        };

        let currentLang = 'en';

        function t(key) {
            return translations[currentLang][key] || key;
        }

        function updateLanguage(lang) {
            currentLang = lang;
            
            // Update language buttons
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.lang === lang);
            });
            
            // Update all text content
            updateAllText();
        }

        function updateAllText() {
            // Progress steps
            document.querySelectorAll('.step')[0].querySelector('.step-label').textContent = t('stepDevice');
            document.querySelectorAll('.step')[1].querySelector('.step-label').textContent = t('stepRepair');
            document.querySelectorAll('.step')[2].querySelector('.step-label').textContent = t('stepQuote');
            if (document.querySelectorAll('.step')[3]) {
                document.querySelectorAll('.step')[3].querySelector('.step-label').textContent = t('stepAppointment');
            }
            
            // Step 1
            document.querySelector('#step1 h1').textContent = t('titleDevice');
            document.querySelector('#step1 .subtitle').textContent = t('subtitleDevice');
            
            // Step 2
            document.querySelector('#step2 h1').textContent = t('titleRepair');
            document.querySelector('#step2 .subtitle').textContent = t('subtitleRepair');
            const repairsText = document.getElementById('selectedRepairsText');
            if (selectedRepairs.length === 0) {
                repairsText.textContent = t('noRepairsSelected');
            }
            
            // Step 3
            document.querySelector('#step3 h1').textContent = t('titleQuote');
            document.querySelector('#step3 .subtitle').textContent = t('subtitleQuote');
            document.querySelector('.summary-title').textContent = t('summaryTitle');
            document.querySelectorAll('.summary-label')[0].textContent = t('summaryDevice');
            document.querySelectorAll('.summary-label')[1].textContent = t('summaryModel');
            document.querySelectorAll('.summary-label')[2].textContent = t('summaryRepairs');
            
            // Service types
            document.querySelector('#shopOption .service-title').textContent = t('serviceShopTitle');
            document.querySelector('#shopOption .service-description').textContent = t('serviceShopDesc');
            document.querySelector('#postOption .service-title').textContent = t('servicePostTitle');
            document.querySelector('#postOption .service-description').textContent = t('servicePostDesc');
            document.querySelectorAll('.service-badge').forEach(badge => {
                badge.textContent = t('serviceBadge');
            });
            
            // Step 4
            document.querySelector('#step4 h1').textContent = t('titleAppointment');
            document.querySelector('#step4 .subtitle').textContent = t('subtitleAppointment');
            document.querySelectorAll('#step4 .section-title')[0].textContent = t('labelSelectDate');
            document.querySelectorAll('#step4 .section-title')[1].textContent = t('labelSelectTime');
            
            // Form labels
            document.querySelector('label[for="firstName"]').textContent = t('labelFirstName') + ' *';
            document.querySelector('label[for="lastName"]').textContent = t('labelLastName') + ' *';
            document.querySelector('label[for="email"]').textContent = t('labelEmail') + ' *';
            document.querySelector('label[for="phone"]').textContent = t('labelPhone') + ' *';
            document.querySelector('label[for="street"]').textContent = t('labelStreet') + ' *';
            document.querySelector('label[for="houseNumber"]').textContent = t('labelHouseNumber') + ' *';
            document.querySelector('label[for="postalCode"]').textContent = t('labelPostalCode') + ' *';
            document.querySelector('label[for="city"]').textContent = t('labelCity') + ' *';
            document.querySelector('label[for="imei"]').textContent = t('labelImei');
            document.querySelector('label[for="notes"]').textContent = t('labelNotes');
            
            // Form placeholders
            document.getElementById('firstName').placeholder = t('placeholderFirstName');
            document.getElementById('lastName').placeholder = t('placeholderLastName');
            document.getElementById('email').placeholder = t('placeholderEmail');
            document.getElementById('phone').placeholder = t('placeholderPhone');
            document.getElementById('street').placeholder = t('placeholderStreet');
            document.getElementById('houseNumber').placeholder = t('placeholderHouseNumber');
            document.getElementById('postalCode').placeholder = t('placeholderPostalCode');
            document.getElementById('city').placeholder = t('placeholderCity');
            document.getElementById('imei').placeholder = t('placeholderImei');
            document.getElementById('notes').placeholder = t('placeholderNotes');
            
            // Buttons
            document.getElementById('nextToRepair').textContent = t('btnContinue');
            document.getElementById('backToDevice').textContent = t('btnBack');
            document.getElementById('nextToQuote').textContent = t('btnContinue');
            document.getElementById('backToRepair').textContent = t('btnBack');
            document.getElementById('continueFromQuote').textContent = t('btnContinue');
            document.getElementById('backToQuote').textContent = t('btnBack');
            document.getElementById('submitAppointment').textContent = t('btnConfirmAppointment');
            
            // Success
            document.querySelector('.success-title').textContent = t('successTitle');
            document.querySelector('.success-text').textContent = t('successText');
            document.querySelector('#success button').textContent = t('btnBackHome');
            
            // Re-render dynamic content
            if (selectedDevice) {
                renderDevices();
                if (devices.find(d => d.id === selectedDevice)?.hasModels && selectedBrand) {
                    renderBrands();
                    renderModels(selectedBrand);
                } else if (devices.find(d => d.id === selectedDevice)?.hasModels) {
                    renderBrands();
                }
            }
            renderRepairs();
            if (selectedRepairs.length > 0) {
                updateSelectedRepairsDisplay();
            }
            if (selectedDate) {
                renderDatePicker();
                renderTimePicker();
            }
        }

        // Mock data (would come from backend)
        const devices = [
            { id: 'smartphones', nameKey: 'deviceSmartphones', descKey: 'deviceSmartphonesDesc', icon: 'üì±', hasModels: true },
            { id: 'laptops', nameKey: 'deviceLaptops', descKey: 'deviceLaptopsDesc', icon: 'üíª', hasModels: false },
            { id: 'wearables', nameKey: 'deviceWearables', descKey: 'deviceWearablesDesc', icon: '‚åö', hasModels: false },
            { id: 'other', nameKey: 'deviceOther', descKey: 'deviceOtherDesc', icon: 'üîß', hasModels: false }
        ];

        // Smartphone brands extracted from CSV
        const featuredBrands = [
            { id: 'apple', name: 'Apple', icon: 'üçé' },
            { id: 'asus', name: 'Asus', icon: 'üéÆ' },
            { id: 'blackberry', name: 'BlackBerry', icon: '‚å®Ô∏è' },
            { id: 'cat', name: 'CAT', icon: 'üèóÔ∏è' },
            { id: 'fairphone', name: 'Fairphone', icon: '‚ôªÔ∏è' },
            { id: 'google', name: 'Google', icon: 'üîç' },
            { id: 'htc', name: 'HTC', icon: 'üì±' },
            { id: 'huawei', name: 'Huawei', icon: 'üì±' },
            { id: 'infinix', name: 'Infinix', icon: 'üì±' },
            { id: 'lenovo', name: 'Lenovo', icon: 'üíª' },
            { id: 'lg', name: 'LG', icon: 'üì±' },
            { id: 'microsoft', name: 'Microsoft', icon: 'ü™ü' },
            { id: 'motorola', name: 'Motorola', icon: 'üì±' },
            { id: 'nokia', name: 'Nokia', icon: 'üì±' },
            { id: 'oppo', name: 'Oppo', icon: 'üì±' },
            { id: 'realme', name: 'Realme', icon: 'üì±' },
            { id: 'samsung', name: 'Samsung', icon: 'üì±' },
            { id: 'sony', name: 'Sony', icon: 'üéÆ' },
            { id: 'vivo', name: 'Vivo', icon: 'üì±' },
            { id: 'xiaomi', name: 'Xiaomi', icon: 'üì±' }
        ];

        const otherBrands = [
            { id: 'honor', name: 'Honor', icon: 'üì±' },
            { id: 'nothing', name: 'Nothing', icon: '‚ö°' },
            { id: 'oneplus', name: 'OnePlus', icon: '1Ô∏è‚É£' },
            { id: 'poco', name: 'Poco', icon: 'üì±' },
            { id: 'tecno', name: 'Tecno', icon: 'üì±' },
            { id: 'alcatel', name: 'Alcatel', icon: 'üì±' }
        ];

        const smartphoneBrands = [...featuredBrands, ...otherBrands];

        // Smartphone models by brand (from CSV)
        const smartphoneModels = {
            apple: [
                'iPhone 15 Pro Max', 'iPhone 15 Pro', 'iPhone 15', 'iPhone 15 Plus',
                'iPhone 14 Pro Max', 'iPhone 14 Pro', 'iPhone 14', 'iPhone 14 Plus',
                'iPhone 13 Pro Max', 'iPhone 13 Pro', 'iPhone 13', 'iPhone SE (3rd gen)'
            ],
            samsung: [
                'Galaxy S24 Ultra', 'Galaxy S24+', 'Galaxy S24',
                'Galaxy S23 Ultra', 'Galaxy S23+', 'Galaxy S23', 'Galaxy S23 FE',
                'Galaxy Z Fold5', 'Galaxy Z Flip5',
                'Galaxy A54 5G', 'Galaxy A34 5G', 'Galaxy A14 5G', 'Galaxy A24'
            ],
            google: [
                'Pixel 8 Pro', 'Pixel 8', 'Pixel 8a', 'Pixel 7a',
                'Pixel 7 Pro', 'Pixel 7', 'Pixel 6a'
            ],
            xiaomi: [
                '14 Ultra', '14 Pro', '14',
                '13T Pro', '13T',
                'Redmi Note 13 Pro+', 'Redmi Note 13 Pro', 'Redmi Note 13', 'Redmi 13C',
                'Poco X6 Pro', 'Poco F5'
            ],
            oneplus: [
                '12', '12R', '11',
                'Nord 3', 'Nord CE 3', 'Nord N30'
            ],
            oppo: [
                'Find X6 Pro', 'Find X5 Pro',
                'Reno 11 Pro', 'Reno 10 Pro+',
                'A78 5G', 'A58'
            ],
            vivo: [
                'X100 Pro', 'X90 Pro',
                'V29 Pro', 'V27 Pro',
                'Y36 5G', 'Y27'
            ],
            motorola: [
                'Edge 40 Pro', 'Edge 40', 'Edge 30 Ultra',
                'Moto G84', 'Moto G73'
            ],
            sony: [
                'Xperia 1 V', 'Xperia 5 V', 'Xperia 10 V', 'Xperia 1 IV'
            ],
            realme: [
                'GT 5 Pro', 'GT Neo 5', '11 Pro+',
                'C55', 'Narzo 60 Pro'
            ],
            nokia: [
                'XR21', 'G60 5G', 'X30 5G'
            ],
            asus: [
                'ROG Phone 7', 'ROG Phone 6',
                'Zenfone 10', 'Zenfone 9'
            ],
            nothing: [
                'Phone (2)', 'Phone (2a)', 'Phone (1)'
            ],
            honor: [
                'Magic 6 Pro', 'Magic 5 Pro', '90', 'X9a'
            ],
            huawei: [
                'P60 Pro', 'Mate 60 Pro', 'Nova 11'
            ],
            tecno: [
                'Phantom X2 Pro'
            ],
            infinix: [
                'Note 30 VIP'
            ],
            poco: [
                'M6 Pro'
            ],
            alcatel: [
                '3L (2021)', '1S (2021)', '3X (2020)'
            ],
            blackberry: [
                'KEY2', 'KEY2 LE', 'Motion'
            ],
            cat: [
                'S75', 'S62 Pro', 'S53'
            ],
            fairphone: [
                '5', '4', '3+'
            ],
            htc: [
                'U23 Pro', 'Desire 22 Pro', 'U20 5G', 'U19e'
            ],
            lenovo: [
                'Legion Y90', 'Legion Phone Duel 2', 'K13 Note', 'K12 Pro'
            ],
            lg: [
                'Wing 5G', 'Velvet 5G', 'V60 ThinQ 5G', 'G8X ThinQ'
            ],
            microsoft: [
                'Surface Duo 2', 'Surface Duo'
            ]
        };

        const repairs = [
            // Display & Touch
            { id: 1, nameKey: 'repairScreen', icon: 'üîß', category: 'display' },
            { id: 19, nameKey: 'repairTouchID', icon: 'üëÜ', category: 'display' },
            { id: 12, nameKey: 'repairFaceID', icon: 'üë§', category: 'display' },
            
            // Accident & Physical Damage
            { id: 3, nameKey: 'repairWater', icon: 'üíß', category: 'accident' },
            { id: 8, nameKey: 'repairBackGlass', icon: 'ü™ü', category: 'accident' },
            { id: 7, nameKey: 'repairButton', icon: 'üîò', category: 'accident' },
            { id: 16, nameKey: 'repairHome', icon: '‚è∫Ô∏è', category: 'accident' },
            
            // Power & Charging
            { id: 2, nameKey: 'repairBattery', icon: 'üîã', category: 'power' },
            { id: 5, nameKey: 'repairCharging', icon: '‚ö°', category: 'power' },
            
            // Audio & Connectivity
            { id: 6, nameKey: 'repairSpeaker', icon: 'üîä', category: 'audio' },
            { id: 11, nameKey: 'repairMicrophone', icon: 'üé§', category: 'audio' },
            { id: 4, nameKey: 'repairCamera', icon: 'üì∑', category: 'audio' },
            { id: 18, nameKey: 'repairWiFi', icon: 'üì∂', category: 'audio' },
            { id: 14, nameKey: 'repairAntenna', icon: 'üì°', category: 'audio' },
            { id: 17, nameKey: 'repairSIM', icon: 'üìá', category: 'audio' },
            
            // Advanced & Internal
            { id: 9, nameKey: 'repairSoftware', icon: 'üíæ', category: 'advanced' },
            { id: 10, nameKey: 'repairData', icon: 'üíø', category: 'advanced' },
            { id: 13, nameKey: 'repairMotherboard', icon: 'üñ•Ô∏è', category: 'advanced' },
            { id: 15, nameKey: 'repairVibration', icon: 'üì≥', category: 'advanced' },
            { id: 20, nameKey: 'repairCheckup', icon: 'üîç', category: 'advanced' }
        ];

        const repairCategories = [
            { id: 'display', nameKey: 'categoryDisplay' },
            { id: 'accident', nameKey: 'categoryAccident' },
            { id: 'power', nameKey: 'categoryPower' },
            { id: 'audio', nameKey: 'categoryAudio' },
            { id: 'advanced', nameKey: 'categoryAdvanced' }
        ];

        // State
        let selectedDevice = null;
        let selectedBrand = null;
        let selectedModel = null;
        let deviceText = null;
        let selectedRepairs = [];
        let serviceType = null; // 'shop' or 'post'
        let selectedDate = null;
        let selectedTime = null;
        let customBrandName = null;
        let customModelName = null;

        // Initialize
        function init() {
            renderDevices();
            renderRepairs();
            setupEventListeners();
        }

        function renderDevices() {
            const grid = document.getElementById('deviceGrid');
            grid.innerHTML = devices.map(device => `
                <div class="card" data-device="${device.id}">
                    <div class="card-icon">${device.icon}</div>
                    <div class="card-title">${t(device.nameKey)}</div>
                    <div class="card-subtitle">${t(device.descKey)}</div>
                </div>
            `).join('');

            grid.querySelectorAll('.card').forEach(card => {
                card.addEventListener('click', () => selectDevice(card.dataset.device));
            });
        }

        function selectDevice(deviceId) {
            selectedDevice = deviceId;
            selectedBrand = null;
            selectedModel = null;
            deviceText = null;

            document.querySelectorAll('#deviceGrid .card').forEach(c => c.classList.remove('selected'));
            document.querySelector(`[data-device="${deviceId}"]`).classList.add('selected');

            // Hide all secondary selection methods
            document.getElementById('brandGrid').style.display = 'none';
            document.getElementById('modelDropdown').style.display = 'none';
            document.getElementById('deviceTextInput').style.display = 'none';

            const device = devices.find(d => d.id === deviceId);

            if (device.hasModels) {
                // Smartphones: show brand selection
                renderBrands();
            } else {
                // Other devices: show text input
                showDeviceTextInput();
            }

            document.getElementById('nextToRepair').disabled = true;
        }

        function renderBrands() {
            const grid = document.getElementById('brandGrid');
            grid.style.display = 'grid';
            
            // Render featured brands as cards
            const brandCards = featuredBrands.map(brand => `
                <div class="card" data-brand="${brand.id}">
                    <img class="card-logo" 
                         src="logos/${brand.id}.svg" 
                         alt="${brand.name}" 
                         onerror="this.onerror=null; this.src='logos/${brand.id}.png'; this.onerror=function(){this.classList.add('hidden');}">
                    <div class="card-title">${brand.name}</div>
                </div>
            `).join('');

            // Add "Other" card
            const otherCard = `
                <div class="card" id="otherBrandCard">
                    <div class="card-icon">üì±</div>
                    <div class="card-title">${t('otherBrandCard')}</div>
                    <div class="card-subtitle">${t('otherBrandCardDesc')}</div>
                </div>
            `;

            grid.innerHTML = brandCards + otherCard;

            // Add click listeners to featured brand cards
            grid.querySelectorAll('.card[data-brand]').forEach(card => {
                card.addEventListener('click', () => {
                    selectBrand(card.dataset.brand);
                    document.getElementById('otherBrandsDropdown').classList.remove('visible');
                });
            });

            // Add click listener to "Other" card
            document.getElementById('otherBrandCard').addEventListener('click', () => {
                showOtherBrandsDropdown();
            });

            // Populate other brands dropdown
            populateOtherBrandsDropdown();
        }

        function populateOtherBrandsDropdown() {
            const select = document.getElementById('otherBrandSelect');
            let optionsHTML = `<option value="">${t('optionChooseBrand')}</option>`;
            
            otherBrands.forEach(brand => {
                optionsHTML += `<option value="${brand.id}">${brand.name}</option>`;
            });
            
            // Add "Not in list" option
            optionsHTML += `<option value="custom">${t('optionBrandNotInList')}</option>`;
            
            select.innerHTML = optionsHTML;
            
            // Update label
            document.querySelector('label[for="otherBrandSelect"]').textContent = t('labelOtherBrand');
            
            // Remove existing listener
            const newSelect = select.cloneNode(true);
            select.parentNode.replaceChild(newSelect, select);
            
            // Add change listener
            document.getElementById('otherBrandSelect').addEventListener('change', (e) => {
                const value = e.target.value;
                
                if (value === 'custom') {
                    // Show custom brand input
                    showCustomBrandInput();
                } else if (value) {
                    // Hide custom brand input
                    document.getElementById('customBrandInput').style.display = 'none';
                    customBrandName = null;
                    
                    selectBrand(value);
                    // Deselect all brand cards
                    document.querySelectorAll('#brandGrid .card').forEach(c => c.classList.remove('selected'));
                    // Select the "Other" card
                    document.getElementById('otherBrandCard').classList.add('selected');
                } else {
                    // Nothing selected
                    document.getElementById('customBrandInput').style.display = 'none';
                    customBrandName = null;
                    selectedBrand = null;
                    selectedModel = null;
                    document.getElementById('modelDropdown').style.display = 'none';
                    document.getElementById('nextToRepair').disabled = true;
                }
            });
        }

        function showCustomBrandInput() {
            const customInput = document.getElementById('customBrandInput');
            customInput.style.display = 'block';
            
            const input = document.getElementById('customBrandText');
            input.value = '';
            
            // Update label and placeholder
            document.querySelector('label[for="customBrandText"]').textContent = t('labelCustomBrand');
            input.placeholder = t('placeholderCustomBrand');
            
            input.focus();
            
            // Hide model dropdown initially
            document.getElementById('modelDropdown').style.display = 'none';
            selectedModel = null;
            document.getElementById('nextToRepair').disabled = true;
            
            // Remove existing listener
            const newInput = input.cloneNode(true);
            input.parentNode.replaceChild(newInput, input);
            
            // Add input listener
            document.getElementById('customBrandText').addEventListener('input', (e) => {
                customBrandName = e.target.value.trim();
                
                if (customBrandName) {
                    // Use custom brand as the selected brand
                    selectedBrand = 'custom';
                    // Show model dropdown with "Other" pre-selected
                    renderModels('custom');
                    // Auto-select "Other" and show custom model input
                    setTimeout(() => {
                        document.getElementById('modelSelect').value = 'Other';
                        selectModel('Other');
                    }, 100);
                } else {
                    selectedBrand = null;
                    selectedModel = null;
                    customModelName = null;
                    document.getElementById('modelDropdown').style.display = 'none';
                    document.getElementById('customModelInput').style.display = 'none';
                    document.getElementById('nextToRepair').disabled = true;
                }
            });
        }

        function showOtherBrandsDropdown() {
            const dropdown = document.getElementById('otherBrandsDropdown');
            dropdown.classList.add('visible');
            
            // Hide custom brand input
            document.getElementById('customBrandInput').style.display = 'none';
            customBrandName = null;
            
            // Deselect all featured brand cards
            document.querySelectorAll('#brandGrid .card[data-brand]').forEach(c => c.classList.remove('selected'));
            
            // Select the "Other" card
            document.getElementById('otherBrandCard').classList.add('selected');
            
            // Reset model selection
            selectedModel = null;
            document.getElementById('modelDropdown').style.display = 'none';
            document.getElementById('nextToRepair').disabled = true;
            
            // Focus on dropdown
            document.getElementById('otherBrandSelect').focus();
        }

        function selectBrand(brandId) {
            selectedBrand = brandId;
            selectedModel = null;
            customModelName = null;

            // Clear previous selections
            document.querySelectorAll('#brandGrid .card').forEach(c => c.classList.remove('selected'));
            
            // If it's a featured brand, select that card
            const featuredCard = document.querySelector(`[data-brand="${brandId}"]`);
            if (featuredCard) {
                featuredCard.classList.add('selected');
                document.getElementById('otherBrandsDropdown').classList.remove('visible');
            } else {
                // It's from the other brands dropdown
                document.getElementById('otherBrandCard').classList.add('selected');
            }

            // Hide custom model input
            document.getElementById('customModelInput').style.display = 'none';

            renderModels(brandId);
            document.getElementById('nextToRepair').disabled = true;
        }

        function showDeviceTextInput() {
            document.getElementById('deviceTextInput').style.display = 'block';
            const input = document.getElementById('deviceText');
            
            input.value = '';
            input.placeholder = t('placeholderDeviceText');
            document.querySelector('label[for="deviceText"]').textContent = t('labelDeviceText');
            input.focus();

            // Remove any existing listener to avoid duplicates
            const newInput = input.cloneNode(true);
            input.parentNode.replaceChild(newInput, input);

            document.getElementById('deviceText').addEventListener('input', (e) => {
                deviceText = e.target.value.trim();
                document.getElementById('nextToRepair').disabled = deviceText.length === 0;
            });
        }

        function renderModels(brandId) {
            const modelDropdown = document.getElementById('modelDropdown');
            const modelSelect = document.getElementById('modelSelect');
            
            modelDropdown.style.display = 'block';
            
            let models = [];
            
            if (brandId === 'custom') {
                // For custom brands, only show "Other" option
                models = [];
            } else {
                models = smartphoneModels[brandId] || [];
            }
            
            // Build options HTML
            let optionsHTML = `<option value="">${t('optionChooseModel')}</option>`;
            models.forEach(model => {
                optionsHTML += `<option value="${model}">${model}</option>`;
            });
            // Add "Other" option
            optionsHTML += `<option value="Other">${t('optionOtherModel')}</option>`;
            
            modelSelect.innerHTML = optionsHTML;
            
            // Update label
            document.querySelector('label[for="modelSelect"]').textContent = t('labelSelectModel');
            
            // Remove existing listener to avoid duplicates
            const newSelect = modelSelect.cloneNode(true);
            modelSelect.parentNode.replaceChild(newSelect, modelSelect);
            
            // Add change listener
            document.getElementById('modelSelect').addEventListener('change', (e) => {
                selectModel(e.target.value);
            });
        }

        function selectModel(model) {
            if (!model) {
                selectedModel = null;
                customModelName = null;
                document.getElementById('customModelInput').style.display = 'none';
                document.getElementById('nextToRepair').disabled = true;
                return;
            }
            
            if (model === 'Other') {
                selectedModel = 'Other';
                showCustomModelInput();
            } else {
                selectedModel = model;
                customModelName = null;
                document.getElementById('customModelInput').style.display = 'none';
                document.getElementById('nextToRepair').disabled = false;
            }
        }

        function showCustomModelInput() {
            const customInput = document.getElementById('customModelInput');
            customInput.style.display = 'block';
            
            const input = document.getElementById('customModelText');
            input.value = '';
            
            // Update label and placeholder
            document.querySelector('label[for="customModelText"]').textContent = t('labelCustomModel');
            input.placeholder = t('placeholderCustomModel');
            
            input.focus();
            
            // Disable continue button until model name is entered
            document.getElementById('nextToRepair').disabled = true;
            
            // Remove existing listener
            const newInput = input.cloneNode(true);
            input.parentNode.replaceChild(newInput, input);
            
            // Add input listener
            document.getElementById('customModelText').addEventListener('input', (e) => {
                customModelName = e.target.value.trim();
                
                if (customModelName) {
                    document.getElementById('nextToRepair').disabled = false;
                } else {
                    document.getElementById('nextToRepair').disabled = true;
                }
            });
        }

        // Generate available dates (next 14 days)
        function generateDates() {
            const dates = [];
            const today = new Date();
            
            for (let i = 1; i <= 14; i++) {
                const date = new Date(today);
                date.setDate(today.getDate() + i);
                dates.push(date);
            }
            
            return dates;
        }

        // Generate time slots
        function generateTimeSlots() {
            return [
                '09:00', '10:00', '11:00', '12:00', 
                '13:00', '14:00', '15:00', '16:00', '17:00'
            ];
        }

        function renderDatePicker() {
            const dates = generateDates();
            const grid = document.getElementById('dateGrid');
            // Monday as first day of week
            const dayNames = ['daySun', 'dayMon', 'dayTue', 'dayWed', 'dayThu', 'dayFri', 'daySat'];
            const monthNames = ['monthJan', 'monthFeb', 'monthMar', 'monthApr', 'monthMay', 'monthJun',
                               'monthJul', 'monthAug', 'monthSep', 'monthOct', 'monthNov', 'monthDec'];
            
            grid.innerHTML = dates.map(date => {
                const dateStr = date.toISOString().split('T')[0];
                const dayIndex = date.getDay(); // 0 = Sunday, 1 = Monday, etc.
                return `
                    <div class="date-card" data-date="${dateStr}">
                        <div class="date-day">${t(dayNames[dayIndex])}</div>
                        <div class="date-number">${date.getDate()}</div>
                        <div class="date-month">${t(monthNames[date.getMonth()])}</div>
                    </div>
                `;
            }).join('');

            grid.querySelectorAll('.date-card').forEach(card => {
                card.addEventListener('click', () => selectDate(card.dataset.date));
            });
        }

        function selectDate(date) {
            selectedDate = date;
            selectedTime = null; // Reset time when date changes
            
            document.querySelectorAll('.date-card').forEach(c => c.classList.remove('selected'));
            document.querySelector(`[data-date="${date}"]`).classList.add('selected');
            
            renderTimePicker();
            document.getElementById('submitAppointment').disabled = true;
        }

        function renderTimePicker() {
            const times = generateTimeSlots();
            const grid = document.getElementById('timeGrid');
            
            grid.innerHTML = times.map(time => {
                // Randomly mark some slots as unavailable for demo purposes
                const isAvailable = Math.random() > 0.3;
                const unavailableClass = isAvailable ? '' : ' unavailable';
                
                return `
                    <div class="time-card${unavailableClass}" data-time="${time}">
                        ${time}
                    </div>
                `;
            }).join('');

            grid.querySelectorAll('.time-card:not(.unavailable)').forEach(card => {
                card.addEventListener('click', () => selectTime(card.dataset.time));
            });
        }

        function selectTime(time) {
            selectedTime = time;
            
            document.querySelectorAll('.time-card').forEach(c => c.classList.remove('selected'));
            document.querySelector(`[data-time="${time}"]`).classList.add('selected');
            
            document.getElementById('submitAppointment').disabled = false;
        }

        function renderRepairs() {
            const container = document.getElementById('repairCategories');
            
            let html = '';
            
            repairCategories.forEach(category => {
                const categoryRepairs = repairs.filter(r => r.category === category.id);
                const selectedCount = categoryRepairs.filter(r => selectedRepairs.includes(String(r.id))).length;
                const countText = selectedCount > 0 ? `${selectedCount}/${categoryRepairs.length}` : `${categoryRepairs.length}`;
                
                html += `
                    <div class="repair-category">
                        <div class="category-header" data-category="${category.id}">
                            <div class="category-title">${t(category.nameKey)}</div>
                            <div class="category-count">${countText}</div>
                            <div class="category-chevron">‚ñº</div>
                        </div>
                        <div class="category-content" data-category-content="${category.id}">
                            <div class="category-grid">
                                ${categoryRepairs.map(repair => `
                                    <div class="card" data-repair="${repair.id}">
                                        <div class="card-icon">${repair.icon}</div>
                                        <div class="card-title">${t(repair.nameKey)}</div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
            
            // Add click listeners to category headers
            container.querySelectorAll('.category-header').forEach(header => {
                header.addEventListener('click', () => toggleCategory(header.dataset.category));
            });
            
            // Add click listeners to all repair cards
            container.querySelectorAll('.card').forEach(card => {
                card.addEventListener('click', () => selectRepair(card.dataset.repair));
            });
            
            // Re-select previously selected repairs
            selectedRepairs.forEach(repairId => {
                const card = container.querySelector(`[data-repair="${repairId}"]`);
                if (card) card.classList.add('selected');
            });
        }

        function toggleCategory(categoryId) {
            const header = document.querySelector(`[data-category="${categoryId}"]`);
            const content = document.querySelector(`[data-category-content="${categoryId}"]`);
            
            const isExpanded = content.classList.contains('expanded');
            
            if (isExpanded) {
                content.classList.remove('expanded');
                header.classList.remove('active');
            } else {
                content.classList.add('expanded');
                header.classList.add('active');
            }
        }

        function selectRepair(repairId) {
            const index = selectedRepairs.indexOf(repairId);
            const card = document.querySelector(`[data-repair="${repairId}"]`);
            
            if (index > -1) {
                // Deselect
                selectedRepairs.splice(index, 1);
                card.classList.remove('selected');
            } else {
                // Select
                selectedRepairs.push(repairId);
                card.classList.add('selected');
            }
            
            updateSelectedRepairsDisplay();
            document.getElementById('nextToQuote').disabled = selectedRepairs.length === 0;
        }

        function updateSelectedRepairsDisplay() {
            const displayElement = document.getElementById('selectedRepairsText');
            
            if (selectedRepairs.length === 0) {
                displayElement.innerHTML = t('noRepairsSelected');
                displayElement.classList.add('empty');
            } else {
                const repairTags = selectedRepairs
                    .map(id => {
                        const repair = repairs.find(r => r.id == id);
                        return `<span class="repair-tag">${repair.icon} ${t(repair.nameKey)}</span>`;
                    })
                    .join('');
                displayElement.innerHTML = repairTags;
                displayElement.classList.remove('empty');
            }
            
            // Update category counts
            repairCategories.forEach(category => {
                const categoryRepairs = repairs.filter(r => r.category === category.id);
                const selectedCount = categoryRepairs.filter(r => selectedRepairs.includes(String(r.id))).length;
                const countText = selectedCount > 0 ? `${selectedCount}/${categoryRepairs.length}` : `${categoryRepairs.length}`;
                
                const countElement = document.querySelector(`[data-category="${category.id}"] .category-count`);
                if (countElement) {
                    countElement.textContent = countText;
                }
            });
        }

        function updateProgress(step) {
            const steps = document.querySelectorAll('.step');
            const progressFill = document.getElementById('progressFill');
            const totalSteps = serviceType === 'shop' ? 4 : 3;

            steps.forEach(s => {
                const stepNum = parseInt(s.dataset.step);
                s.classList.remove('active', 'completed');
                if (stepNum < step) s.classList.add('completed');
                if (stepNum === step) s.classList.add('active');
            });

            const progress = ((step - 1) / (totalSteps - 1)) * 100;
            progressFill.style.width = `${progress}%`;
        }

        function goToStep(step) {
            document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
            document.getElementById(`step${step}`).classList.add('active');
            updateProgress(step);
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function updateSummary() {
            const device = devices.find(d => d.id === selectedDevice);
            const repairList = selectedRepairs
                .map(id => {
                    const repair = repairs.find(r => r.id == id);
                    return t(repair.nameKey);
                })
                .join(', ');
            
            document.getElementById('summaryDevice').textContent = t(device.nameKey);
            
            // Handle different device selection types
            if (device.hasModels) {
                let brandName = '';
                let modelName = '';
                
                if (selectedBrand === 'custom') {
                    // Custom brand entered by user
                    brandName = customBrandName;
                } else {
                    // Regular brand from list
                    const brand = smartphoneBrands.find(b => b.id === selectedBrand);
                    brandName = brand.name;
                }
                
                if (selectedModel === 'Other' && customModelName) {
                    // Custom model entered by user
                    modelName = customModelName;
                } else {
                    modelName = selectedModel;
                }
                
                document.getElementById('summaryModel').textContent = `${brandName} - ${modelName}`;
            } else {
                document.getElementById('summaryModel').textContent = deviceText;
            }
            
            document.getElementById('summaryRepair').textContent = repairList;
        }

        function setupEventListeners() {
            // Language switcher
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    updateLanguage(btn.dataset.lang);
                });
            });

            // Service type selection
            document.querySelectorAll('.service-option').forEach(option => {
                option.addEventListener('click', () => {
                    serviceType = option.dataset.service;
                    document.querySelectorAll('.service-option').forEach(o => o.classList.remove('selected'));
                    option.classList.add('selected');
                    
                    // Show/hide step 4 indicator based on service type
                    const step4indicator = document.getElementById('step4indicator');
                    if (serviceType === 'shop') {
                        step4indicator.style.display = 'flex';
                    } else {
                        step4indicator.style.display = 'none';
                    }
                    
                    // Enable continue button
                    document.getElementById('continueFromQuote').disabled = false;
                });
            });

            document.getElementById('nextToRepair').addEventListener('click', () => {
                goToStep(2);
            });

            document.getElementById('backToDevice').addEventListener('click', () => {
                goToStep(1);
            });

            document.getElementById('nextToQuote').addEventListener('click', () => {
                updateSummary();
                goToStep(3);
            });

            document.getElementById('backToRepair').addEventListener('click', () => {
                goToStep(2);
            });

            document.getElementById('continueFromQuote').addEventListener('click', () => {
                // Validate form first
                const form = document.getElementById('quoteForm');
                if (!form.checkValidity()) {
                    form.reportValidity();
                    return;
                }
                
                if (serviceType === 'shop') {
                    // Go to appointment booking
                    renderDatePicker();
                    goToStep(4);
                } else {
                    // Submit directly
                    submitRequest();
                }
            });

            document.getElementById('backToQuote').addEventListener('click', () => {
                goToStep(3);
            });

            document.getElementById('submitAppointment').addEventListener('click', () => {
                submitRequest();
            });
        }

        function submitRequest() {
            // Collect form data
            const formData = {
                device: selectedDevice,
                brand: selectedBrand === 'custom' ? customBrandName : selectedBrand,
                customBrand: customBrandName,
                model: selectedModel === 'Other' && customModelName ? customModelName : selectedModel,
                customModel: customModelName,
                deviceText: deviceText,
                repairs: selectedRepairs,
                serviceType: serviceType,
                firstName: document.getElementById('firstName').value,
                lastName: document.getElementById('lastName').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                street: document.getElementById('street').value,
                houseNumber: document.getElementById('houseNumber').value,
                postalCode: document.getElementById('postalCode').value,
                city: document.getElementById('city').value,
                imei: document.getElementById('imei').value,
                notes: document.getElementById('notes').value
            };

            if (serviceType === 'shop') {
                formData.appointmentDate = selectedDate;
                formData.appointmentTime = selectedTime;
            }

            console.log('Form submitted:', formData);

            document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
            document.getElementById('success').classList.add('active');
        }

        init();
    </script>
</body>
</html>